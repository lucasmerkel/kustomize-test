const cds = require('../cds')

const addExtension = require('./addExtension')
const { add, promote } = require('./add')
const { base, push } = require('./push')
const { transformExtendedFieldsCREATE, transformExtendedFieldsUPDATE } = require('./handler/transformWRITE')
const { transformExtendedFieldsREAD } = require('./handler/transformREAD')
const { transformExtendedFieldsRESULT } = require('./handler/transformRESULT')

module.exports = async function () {
  this.on('addExtension', addExtension)
  this.on('add', add)
  this.on('promote', promote)
  this.on('base', base)
  this.on('push', push)
  cds.db
    .before('CREATE', transformExtendedFieldsCREATE)
    .before('UPDATE', transformExtendedFieldsUPDATE)
    .before('READ', transformExtendedFieldsREAD)
    .after('READ', transformExtendedFieldsRESULT)
}
